<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Plant Care Assistant</title>
  <!-- Framer Motion (UMD version) -->
  <script src="https://unpkg.com/framer-motion/dist/framer-motion.umd.js"></script>
  <style>
    body {
      min-height: 100vh;
      background-color: #e8f5e9;
      font-family: system-ui, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      margin: 0;
      position: relative;
    }
    h1 { font-size: 2rem; font-weight: bold; margin-bottom: 1.5rem; }
    .button-group { display: flex; gap: 1rem; margin-bottom: 1.5rem; flex-wrap: wrap; justify-content: center; }
    button { background-color: #4caf50; color: white; border: none; border-radius: 8px; padding: 0.75rem 1.25rem; cursor: pointer; font-size: 1rem; }
    .card { width: 100%; max-width: 400px; background-color: white; border: 1px solid #ccc; border-radius: 10px; padding: 1rem; display: flex; flex-direction: column; gap: 0.75rem; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    select { padding: 0.5rem; font-size: 1rem; border-radius: 5px; border: 1px solid #ccc; }
    .search-button { background-color: #81c784; color: white; border: none; border-radius: 6px; padding: 0.5rem 1rem; cursor: pointer; }
    pre { white-space: pre-wrap; margin-top: 1rem; font-size: 1rem; color: #333; }
    .flower-row { position: absolute; bottom: 10px; left: 0; width: 100%; display: flex; justify-content: space-around; padding: 0 1rem; }
    .flower { font-size: 1.5rem; }
  </style>
</head>
<body>

<h1>🌱 Plant Care Assistant</h1>

<div class="button-group">
  <button id="waterBtn">How much to water plants</button>
  <button id="helpBtn">My plant isn’t doing well</button>
</div>

<div id="card" class="card" style="display:none;">
  <select id="plantSelect">
    <option value="">Select a plant...</option>
  </select>
  <button id="searchBtn" class="search-button">Search</button>
  <pre id="result"></pre>
</div>

<div class="flower-row" id="flowers"></div>

<script>
  const API_KEY = "sk-QaVy68e289b31be2b12144"; // your Perenual API key

  let mode = null;
  let availablePlants = [];

  const card = document.getElementById("card");
  const plantSelect = document.getElementById("plantSelect");
  const resultEl = document.getElementById("result");
  const flowersEl = document.getElementById("flowers");

  document.getElementById("waterBtn").onclick = () => selectMode("water");
  document.getElementById("helpBtn").onclick = () => selectMode("help");

  function selectMode(selectedMode) {
    mode = selectedMode;
    card.style.display = "flex";
    resultEl.textContent = "";
    addFlowers();
  }

  function addFlowers() {
    flowersEl.innerHTML = "";
    for (let i = 0; i < 10; i++) {
      const f = document.createElement("div");
      f.textContent = "🌸";
      f.className = "flower";
      f.style.opacity = 0;
      f.style.transform = "translateY(20px)";
      flowersEl.appendChild(f);
      setTimeout(() => { f.style.transition = "all 0.5s"; f.style.opacity = 1; f.style.transform = "translateY(0)"; }, i * 100);
    }
  }

  async function fetchPlants() {
    try {
      const res = await fetch(`https://perenual.com/api/species-list?key=${API_KEY}`);
      const data = await res.json();
      availablePlants = data.data.map(p => p.common_name).filter(Boolean).slice(0, 30);
      availablePlants.forEach(p => {
        const option = document.createElement("option");
        option.value = p;
        option.textContent = p;
        plantSelect.appendChild(option);
      });
    } catch (err) {
      console.error("Error fetching plants:", err);
    }
  }

  document.getElementById("searchBtn").onclick = async () => {
    const plant = plantSelect.value;
    if (!plant) { resultEl.textContent = "Please select a plant first!"; return; }

    resultEl.textContent = "Loading...";
    addFlowers();

    try {
      const res = await fetch(`https://perenual.com/api/species-list?key=${API_KEY}&q=${plant}`);
      const data = await res.json();
      const plantData = data.data?.[0];
      if (!plantData) { resultEl.textContent = "No data found 🌱"; return; }

      let message = `🌿 Info for ${plantData.common_name || plant}:\n`;
      if (mode === "water") {
        message += `💧 Watering: ${plantData.watering || "Water moderately based on soil moisture."}\n`;
        message += `☀️ Sunlight: ${plantData.sunlight || "Provide bright, indirect light."}\n`;
        message += `🪴 Soil: ${plantData.soil_type || "Use well-draining potting mix."}`;
      } else {
        message += `🌱 Propagation: ${plantData.propagation || "Try adjusting water, sunlight, or soil conditions."}\n`;
        message += `🌡️ Temperature: ${plantData.temperature || "Keep in moderate indoor temperatures."}\n`;
        message += `☀️ Sunlight: ${plantData.sunlight || "Adjust lighting as needed."}\n`;
        message += `💧 Watering: ${plantData.watering || "Avoid overwatering; check soil moisture."}`;
      }
      resultEl.textContent = message;
    } catch (err) {
      resultEl.textContent = "⚠️ Network error. Please check your connection.";
    }
  }

  fetchPlants();
</script>

</body>
</html>
